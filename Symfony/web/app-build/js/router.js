define(["jQuery","Underscore","Backbone","views/main_panel/event_details","views/main_panel/event_creation","views/calendar/calendar","views/main_panel/user_profile","views/main_panel/recommendations","views/main_panel/search","event_manager"],function(e,t,n,r,i,s,o,u,a,f){var l=n.Router.extend({initialize:function(){this.recommendationsView=new u,this.route(/^!\/([0-9]{4}-[0-9]{2})$/,"showCalendar"),this.calendar=s,f.on("editEvent",this.createEvent,this)},routes:{"!/create-event":"createEvent","!/recommendations":"showRecommendations","!/event/:id":"showEvent","!/:username":"showUser","!/search/:keyword":"search","*path":"showCalendar"},routesInfos:{event_creation:{route:"create-event"},calendar:{route:":date",parameters:{date:/[0-9]{4}-[0-9]{2}/}},event:{route:"event/:id",parameters:{id:/[0-9]+/}},user:{route:":username",parameters:{username:/[a-zA-Z0-9_]+/}},recommendations:{route:"recommendations"},search:{route:"search/:keyword",parameters:{keyword:/.*/}},top:{route:""}},getDefaultRoute:function(){return this.routesInfos.top},showEvent:function(e){r.update(e)},showUser:function(e){o.update(e)},search:function(e){a.search(e),f.trigger("loaded",a)},generateRoute:function(e,t){t=t||{};var n=this.routesInfos[e]||this.getDefaultRoute(),r=n.parameters,i=n.route;for(var s in r){if(!(s in t)||!r[s].exec(t[s]))return!1;i=i.replace(":"+s,t[s])}return"!/"+i},showRecommendations:function(){f.trigger("loaded",this.recommendationsView)},createEvent:function(e){typeof e=="undefined"?i.resetModel():i.setModel(e),this.navigate(this.generateRoute("event_creation")),f.trigger("loaded",i)},showCalendar:function(e){e=e||"";var t=new Date(Date.parse(e));isNaN(t.getTime())&&(t=new Date),s.setDate(t),f.trigger("loaded",s)}}),c=function(){var e=new l;return n.history.start(),e};return{initialize:c}});