define(["jQuery","Underscore","Backbone"],function(e,t,n){var r=n.RelationalModel.extend({defaults:function(){return{date:Date.getCurrent(),allDay:!0}},initialize:function(){this.get("date")||this.set("date",this.defaults.date),this.get("allDay")||this.set("allDay",this.defaults.allDay),this.bind("change",this.checkAllDay,this)},checkAllDay:function(){typeof this.get("allDay")=="undefined"&&this.set("allDay",!1)},timelineCategory:function(){return this.get("date").getCategory()},isSameDate:function(e){return this.get("date").dateEquals(e.get("date"))},compare:function(e){return this.isSameDate(e)?this.get("allDay")!==e.get("allDay")?this.get("allDay")?1:-1:this.get("allDay")?0:e.get("date")-this.get("date"):e.get("date")-this.get("date")},parse:function(e){return r.parse(e)},format:function(){var e=this.toJSON(),t=this.get("date");return e.date=t.format("Y/m/d"),e.time=t.format("H:i"),Object.keysToCamelCase(e)},getString:function(e){e=typeof e!="undefined"?new Date(e):new Date,e.setFullYear(e.getFullYear()+1);var t="",n=this.get("date"),r=n<e?"month_day_dow":"year_month_day_dow",i=ExposeTranslation.get("time."+r);return t+=n.format(i),this.get("allDay")||(t+=" "+n.format("H:i")),t}});return r.parse=function(e){var t={},n=e.date;return t.date=new Date(n.year,n.month-1,n.day),t.allDay=e.all_day||e.allDay,t.allDay||t.date.setHours(e.time.hour,e.time.minute),t},r});